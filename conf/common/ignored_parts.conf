### Parts that should be ignored by rules
### This file is ALWAYS backward-compatible and should always be updated on all systems

# HTTP parameters to ignore
DefineStr _dotnetArgs_     "^__(?:event(?:argument|target|validation)|request(digest|verificationtoken)|s_ria|viewstate)"
DefineStr _jqueryArgs_     "^Exception.AjaxOptions"
DefineStr _passwArgs_      "pass(?:code|w)|pw[d12]|old_pw|secretkey"
DefineStr _samlArgs_       "^saml(?:art|request|response)$"
DefineStr _miscArgs_       "^gclid$|^QLogEnv|^redirect$|^referr?er$"
DefineStr _base64Args_     "base64|^https?:..ids[.]connective[.]eu|^token$"
#DefineStr _aws_            "^AwsAccessKeyId$|^X-Amz-Credential$"
DefineStr _gcloud_         "^GoogleAccessId$"
# Don't check LiveWire internal structures (redundant with real data)
DefineStr LivewireArgs_    "(?:fingerprint|serverMemo)[.].*"
DefineStr IgnoredArgs_     "/(?i:(?:~{_dotnetArgs_})|(?:~{_jqueryArgs_})|(?:~{_passwArgs_})|(?:~{_samlArgs_})|(?:~{_miscArgs_})|(?:~{_base64Args_})|(?:~{_gcloud_})|(?:~{LivewireArgs_}))/"
DefineStr IgnoredArgs      -
DefineStr EmergencyIgnoredArgs      -
DefineStr args    "ARGS|!ARGS:'~{IgnoredArgs_}'|!ARGS:'~{IgnoredArgs}'|!ARGS:'/^~{EmergencyIgnoredArgs}$/'"
<IfDefine !noOptimExceptions>
 DefineStr args    "ARGS"
</IfDefine>
# HTTP parameters names to ignore
#  - date/time (usually in query)
#  - Connective namespace (in JSON)
DefineStr IgnoredArgNames_ "[0-9-]+(?:T[0-9:]+(?:Z[+-]?[0-9:]*)?)?$|https?:..ids[.]connective[.]eu"
DefineStr IgnoredArgNames  -
DefineStr EmergencyIgnoredArgNames  -
# HTTP parameters names to accept for static pages (search engines)
DefineStr IgnoredArgStatic_ "^(?:(?:fb|g)clid)$"
DefineStr IgnoredArgStatic  -

# Cookies to ignore: __utm..., first_utm_...., handl_... & ssm_au_c (used by Google analytics), ltpatoken (WebSphere), mysapsso2 (SAP), ...
DefineStr IgnoredCookies1_ "^(?:_(?:_atuv|cf|cl[cs]k$|_gpi|g(?:a|id)|hs|_RequestVerificationToken$)|acl|BEAMER_|CF(?:GLOBALS|IDE|TOKEN)|InfoPath_CanaryValue|pk_(?:cvar|hsr|u?id|ref|sess)|#(?:env|sess|srchist|tsa|uid|vdf)$|Ribbon[.]|xf_)"
DefineStr IgnoredCookies2_ "^(?:_hp2_|(?:_*|first_)utm[a-z_]|ai_user$|amplitude_|amcvs_|amvc_|ba$|campaign_cookie|clrc$|DSPREAUTH$|dt(?:Cookie|LatC|Pc|Sa)$|fbsr_|FedAuth[0-9]{0,3}$|handl_|Iist$|JCS_INENREF$|kentor[.]|km_|ltpatoken|metrixlabglob_localcookie|mp_[0-9a-z]+_mixpanel|mysapsso|optimizely|rsa-local$|s_|SimpleSAMLAuthToken|v_reco_data|visitor_aa_|waf_|WASReqURL$|WSS_ExpGroup)"
DefineStr IgnoredCookies3_ "(?:ajs[._]|mxpnl|opera-interstitial|referr?er|SERVERID585|sessi(?:d|on)|ssm_au_c|[cx]srf|state|wmsaffinity-dotnetsearch)"
# Oracle analytics: https://docs.oracle.com/cloud/latest/marketingcs_gs/OMCGB/cd-api/cookies/
DefineStr IgnoredCookies4_ "^(?:maxymiser[.]|mm(?:api|core|pa)[.])"
# For identityserver.io
DefineStr IgnoredCookies5_ "(?:^(?:did$|idsrv|SignInMessage[.]))"
# For Keycloak
DefineStr IgnoredCookies6_ "(?:^(?:KC_RESTART|KEYCLOAK_IDENTITY(?:_LEGACY)?)$)"
# For ZScaler/Clouflare
DefineStr IgnoredCookies7_ "^_sm_au(?:_[cd])?$"
# For AspNetCore
DefineStr IgnoredCookies8_ "^[.]AspNetCore[.](?:Cookies|Culture$|OpenIdConnect[.])"
# Dynatrace
DefineStr IgnoredCookies9_ "^(?:rxvt)$"
# DC Storm
DefineStr IgnoredCookies10_ "^_#(?:env|[pu]?id|sess|srchist|tsa|vdf)|rmlconsent_"
# Misc
DefineStr IgnoredCookies11_ "^organic_source$"
# For OWin / Katana
DefineStr OWinCookies_ "^(?:[.]AspNet[.]ExternalCookie$|OpenIdConnect[.]nonce[.])"
# For OneTrust cookie consent manager
DefineStr OneTrustCookies_ "^(?:OptanonConsent)$"
# For consent managers
DefineStr ConsentCookies_ "^ab[.]|ABTasty|C5tM5s_origin^$|^cc_consentCookie$|^cooki(?:eyes|hub)|^_iub_cs-|^eupubconsent$|^TC_(?:CJ|OPTOUT|PRIVACY)|^TCAUDIENCE$|^utag_main|^wid$"
# For AT Internet Developers
DefineStr at_intdev_ "^at(?:tvt)?(?:authority|id|reman|redir|session|userid|webosession)|^idrxvr|^tmst|^xt(?:a[nt]date|go|id[ce]|ocl|or|ref|tvt|valCZ|vid|vrn|wd)"
# For Incapsula
DefineStr IncapCookies_ "^(?:visid_)?incap_"
# For VWO
DefineStr VwoCookies_ "^(?:_vis_opt_|_vwo|pshcrw_|pushcrew_|wingify_)"
# For Tawk.io for the live chat tool
DefineStr TwkCookies_ "^twk_uuid_"
# For Braze Web SDK
DefineStr BrazeCookies_ "^ab.storage.userId"
# For LinkedIn
DefineStr LinkedInCookies_ "-xLiTrack|user_agent"
# For PeopleSoft
DefineStr PeoplesoftCookies_ "^PS_DEVICEFEATURES$"
# For Akamai
DefineStr AkamaiCookies_ "^(?:ak_bmsc|bm_(?:mi|sv)|janrainCaptureReturnExperienceData)$|^pia_id_"
# For Adobe Experience Cloud Identity Service
DefineStr AdobeCookies_ "AdobeOrg$"

# Obsolete syntax in some clients
#DefineStr IgnoredCookies9_ "^[$](?:Domain|Path|Version)$"
DefineStr IgnoredCookies_  "/(?i)(?:token|^~{OIDCCookiePrefix}|~{IgnoredCookies1_}|~{IgnoredCookies2_}|~{IgnoredCookies3_}|~{IgnoredCookies4_}|~{IgnoredCookies5_}|~{IgnoredCookies6_}|~{IgnoredCookies7_}|~{IgnoredCookies8_}|~{IgnoredCookies9_}|~{IgnoredCookies10_}|~{IgnoredCookies11_}|~{OWinCookies_}|~{OneTrustCookies_}|~{at_intdev_}|~{ConsentCookies_}|~{IncapCookies_}|~{VwoCookies_}|~{TwkCookies_}|~{BrazeCookies_}|~{LinkedInCookies_}|~{PeoplesoftCookies_}|~{AkamaiCookies_})/"
DefineStr IgnoredCookies   -
DefineStr EmergencyIgnoredCookies   -
DefineStr cookies     "REQUEST_COOKIES|!REQUEST_COOKIES:'~{IgnoredCookies_}'|!REQUEST_COOKIES:'~{IgnoredCookies}'|!REQUEST_COOKIES:'~{EmergencyIgnoredCookies}'"
DefineStr cookienames "REQUEST_COOKIES_NAMES|!REQUEST_COOKIES_NAMES:'~{IgnoredCookies_}'|!REQUEST_COOKIES_NAMES:'~{IgnoredCookies}'|!REQUEST_COOKIES_NAMES:'~{EmergencyIgnoredCookies}'"
<IfDefine !noOptimExceptions>
 DefineStr cookies     REQUEST_COOKIES
 DefineStr cookienames REQUEST_COOKIES_NAMES
</IfDefine>

DefineStr VeryLongHeaders   "/^(?i:Accept|Authorization|Cookie2?|If-None-Match|Proxy-Authorization|Range|Referer|X-ScanSafe-Data|User-Agent|X-(?:Device-Accept|SFS-Embed|vf-acr|WAP-Profile-Diff))$/"
# Headers to ignore
DefineStr IgnoredHeaders1_     "^(?:Accept|Content-ID|Cookie[2s]?|From|If|If-None-Match|Intervention|Keep-Alive|lock-token|notification-type|Origin|Referer|Request-(?:Context|Id)|Sec-CH-.*|Sec-WebSocket-Key|sessi(?:d|on)|SOAPAction|SSL_CLIENT_S_DN|User-Agent|Via)$"
DefineStr IgnoredHeaders_wl    "^(?i:Accept-Encoding|Authorization|Connection|Content-(?:Encoding|Length|Type)|Depth|DNT|Host|HTTPS|If-(?:Un)?modified-Since|Keep-Alive|Max-Forwards|(?:Request-)?Range|Referer|TE|Timeout|Upgrade-Insecure-Requests|X-Forwarded-For|~{IPAddressHeader})$"
DefineStr IgnoredHeaders_oidc  "token|^DPoP$"
DefineStr IgnoredHeaders_misc1 "^X-(?:Authenticated-User|Amzn?-|ClientSide|Falcon-Info|MS-APIM|ms-request-(?:root-)?id|SFS-|Wap-)"
DefineStr IgnoredHeaders_misc2 "^(?:X-Apppath$|Sec-Datadog$|^Correlation-Context$)"
DefineStr IgnoredHeaders_li    "^(?:X-LI|LI-Track)"
DefineStr IgnoredHeaders_TraceContext "^tracestate$"
DefineStr IgnoredHeaders_waf   "^X-Proxy-(?:BackendRoot|Request(?:Path|Root))$"
DefineStr IgnoredHeaders_test   $^
<IfDefine ClientStatus>
 DefineStr IgnoredHeaders_test "^(?:X-(?:mock-|WAF-(?:AlwaysBlock|ErrorJS)$)|TST-)"
</IfDefine>
DefineStr IgnoredHeaders_ "/(?i)(?:~{IgnoredHeaders_waf}|~{IgnoredHeaders1_}|~{IgnoredHeaders_oidc}|~{IgnoredHeaders_wl}|~{IgnoredHeaders_misc1}|~{IgnoredHeaders_misc2}|~{IgnoredHeaders_li}|~{IgnoredHeaders_TraceContext}|~{IgnoredHeaders_test})/"
# Bug in some versions of Chrome/Samsung: CookieS instead of Cookie
DefineStr IgnoredHeaders  -
DefineStr EmergencyIgnoredHeaders  -
DefineStr ReqHeaders  "REQUEST_HEADERS|!REQUEST_HEADERS:/^OIDC_/|!REQUEST_HEADERS:Cookies|!REQUEST_HEADERS:'~{IgnoredHeaders_}'|!REQUEST_HEADERS:'~{IgnoredHeaders}'|!REQUEST_HEADERS:'/^~{EmergencyIgnoredHeaders}$/'"
<IfDefine !noOptimExceptions>
 DefineStr ReqHeaders "REQUEST_HEADERS|!REQUEST_HEADERS:/^OIDC_/"
</IfDefine>
# Response headers to ignore "X-..." ("^X-" is implied)
DefineStr IgnoredResponseHeadersWAF_   "(?:city|country|hacker|org-location|SecError-|test|Unique-id$|WAF-)[a-z-]*"
DefineStr IgnoredResponseHeadersOther_ "aspnet(?:mvc)?-version|backend|botdetect-str|content-(?:security-policy|type-options)|csrf.*|download-options|firefox-spdy|force-tls|forms_based_auth_re(?:quired|turn_url)|frame-options|kong-(?:proxy|response|upstream)-latency|microsoftajax|mod-pagespeed|ms(?:-|davext|fsshttp)|otrs-login|Permitted-Cross-Domain-Policies.*|pingback|powered-by|rack-cache|request(?:digest|-id)|robots-tag|runtime|sharepointhealtscore|streamer-method|svn.*|tfs-(?:rh|serviceerror|(?:soap)?exception)|ua-compatible|versioncontrol-exception|webkit-csp|aws-ec2-metadata-token-ttl-seconds|xss-protection"
DefineStr IgnoredResponseHeaders_ "~{IgnoredResponseHeadersWAF_}|~{IgnoredResponseHeadersOther_}"
DefineStr IgnoredResponseHeaders  -

# To allow (even non standard clients) access to site icon, robots.txt, Google analytics data, etc.
# Must encompass the whole path (used in redirection)
DefineStr PathToIgnoreIcons  "(?:/(?i:favicon[.]ico$|apple-touch-icon.*[.]png$|labels[.]rdf$|mstile-.*[.]png$))"
DefineStr PathToIgnoreRobots "(?:^/(?:[.]well-known/(?:apple-app-site-association|assetlinks.json|openid-configuration)|robots[.]txt|(?:(?:browserconfig|sitemap(?:_?index)?|(?i:(?:bing|livesearch)siteauth)|clientaccesspolicy|crossdomain|trafficbasedsspsitemap|w3c/p3p)[.]xml|sitemap[.]html)(?:[.]gz)?$))"
DefineStr PathToIgnoreOthers "(?:/(?:app-ads[.]txt|rules[.]abe|__utm[.]gif|manifest[.]json)$)"
DefineStr PathToIgnoreRootFiles  "$^"
DefineStr PathToIgnoreRoot  "(?:~{PathToIgnoreIcons}|~{PathToIgnoreRobots}|~{PathToIgnoreOthers}|~{PathToIgnoreRootFiles})"
DefineStr PathToIgnore      "(?:~{PathToIgnoreIntern}|~{PathToIgnoreRoot})"

# Globally trusted service providers
#  ids.connective.eu: to have Connective plugin working
#  java.sun.com: for XML namespaces
#  registry.npmjs.org: NPM namespaces
#  we.tl: wetransfer short URL (cannot be used to automatically download a file)
#  www.w3.org: for XML namespaces
# Payments: pay.stripe.com, redirect.jforce.be, *.mollie.com
DefineStr TrustedHosts_        "ids[.]connective[.]eu|img[.]youtube[.]com|java[.]sun[.]com|(?:hooks|pay)[.]stripe[.]com|login[.]microsoftonline[.]com|redirect[.]jforce[.]be|registry[.]npmjs[.]org|we[.]tl|schemas[.](?:microsoft[.]com|xmlsoap[.]org)|sign[.]itsme[.]be|www[.]w3[.]org"
DefineStr TrustedHosts         @
DefineStr TrustedDomainsPay_   "(?:paypal|stripe)[.]com"
DefineStr TrustedDomainsOther_ "mollie[.]com"
DefineStr TrustedDomains_      "~{TrustedDomainsPay_}|~{TrustedDomainsOther_}"
DefineStr TrustedDomains       @
DefineStr TrustedLocations   "(?:%{TX.TrustedHosts}|~{TrustedHosts}|~{AdditionalServerNames}|~{TrustedHosts_}|(?:~{HostChars}+[.])?(?:~{TrustedDomains_}|~{TrustedDomains}))\b"

# Special protocols (proto:///...) that aren't risky (no more used from 8-2022)
DefineStr AllowedProtos "(?:vstfs)"
