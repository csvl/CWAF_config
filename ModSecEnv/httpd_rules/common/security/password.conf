# ModSecurity rules for usual userid/password
# ---------------------------------------------------------------

<Macro SecKnownUserid $user $id>
  SecRule ARGS|REQUEST_COOKIES "\b(?:$user)\b"  "phase:2,t:~{jsDecode},id:$id,~{nosecaction},setvar:tx.known_userid=+1"
</Macro>

<Macro SecUseridPwd $user $pwd $id>
  Use SecRule     ARGS|REQUEST_COOKIES "!\b(?:$user)\b"  "phase:2,id:$id,t:~{jsDecode},tag:security,~{skipAfter}:AfterUseridPwd"
   Use SecRuleDeny ARGS|REQUEST_COOKIES "\b(?:$pwd)\b"   "phase:2,id:$id,t:~{jsDecode},msg:'Known userid/password'"
  Use SecMarker AfterUseridPwd,tag:security
</Macro>


# Generic userid/passwords --------------------------------------------

# Capture known userid
Use SecKnownUserid "adm(?:in(?:istrator)?)?|root|guest|user[0-9]+|anon|bbs|daemon|(?:post|web)master"  "2001801,setvar:tx.known_userid=+1"

# Warning: these could lead to false positives if in above rule (twice in same argument)
Use SecKnownUserid   "^(?:sa|user|demos?|http)$"    2001802

Use SecRuleArgsCookies  "\bchange(?:me|it)\b"  2001804,~{caseSensitive},tag:PossibleName,tag:EXPLOIT


# ----------------------------------------------------------------------

# Unix
Use SecUseridPwd  "bin|system"             "sys"               2001805
Use SecUseridPwd  "console|http"           "administrator"     2001806
Use SecUseridPwd  "check|u?mount)fs(?:ys)?|lpadm(?:in)?|n?uucp(?:adm)?|sys(?:tem_)?(?:adm(?:in)?|bin" . 2001807

# Linux
Use SecUseridPwd  "uClinux|gonzo" . 2001808

Use SecKnownUserid  "superuser|ftp|gopher|informix|lp|man|dni|fal|postmaster|(?:power|shut)down|rje|trocse"  2001809
Use SecKnownUserid  "^operator$"  2001810

# Windows (IIS)
Use SecUseridPwd  "is_\$.*"   .  2001811

# Oracle
Use SecUseridPwd  "scott"             "tiger"               2001814
Use SecUseridPwd  "adams"             "wood"                2001815
Use SecUseridPwd  "blake"             "paper"               2001816
Use SecUseridPwd  "clark"             "cloth"               2001817
Use SecUseridPwd  "jones"             "steel"               2001818
#Use SecUseridPwd  "system"            "manager"             2001819
Use SecUseridPwd  "applsys|dbsnmp|mdsys|aurora[@$]orb[@$]unauthenticated|ctx(?:demo|sys)|ord(?:sys|plugins)|outln|rman|change_on_install|tracesrv|aqdemo|sysman|gp(?:f|l)d|emp|fnd|mfg|mmo2|ocitest|powercartuser|pubsub|secdemo|ts(?:dev|user)|vvr1|aquser|modtest|mtysys|rmail|po8|webdb" .     2001820
Use SecKnownUserid  "apps|miller|cdemo[a-z0-9]*|moreau|po|oracle"  2001812
Use SecKnownUserid  "names|finance|primary|gp(?:f|l)d"             2001813


# DB2
Use SecUseridPwd  "db2admin" . 2001821

# BEA Weblogic
Use SecUseridPwd  "system" "weblogic|security|password" 2001822
Use SecKnownUserid  "wl(?:pi|c)system"                  2001823

# Borland InterBase
Use SecUseridPwd  "politically"  "correct"   2001824
Use SecUseridPwd  "sysdba|masterkey"  .      2001825

# PostgreSQL
Use SecUseridPwd  "postgres"  .  2001826

# Lotus Domino
Use SecUseridPwd  "(?:web|nc)admin"  .  2001827

# phpTest
Use SecUseridPwd  "admin"  "1234"  2001828

# SAP
Use SecUseridPwd  "sap(?:cpic|\*)|ddic|earlywatch|isdev|iscopy|itsadmin|tmsadm|sapr3"  .  2001829

# Symantec AV
Use SecUseridPwd  "admin"  "symantec"  2001830

# IBM CICS & RACF
#????????Use SecUseridPwd  "sysadm|(?:\|vc)$srv|prodcics|cicsuser|dbdccics|ibmuser"  .  2001831
Use SecKnownUserid  "prog|oper|forse"  2001832

# IBM OS/400
Use SecUseridPwd  "qsrv|sedacm|sysopr|qpgmr|qserv|quser|qsrvbas|qsysopr|ap2svp|apl2pp|autolog[0-9]+|batch[0-9]+"  . 2001833
Use SecKnownUserid  "11111111|22222222"  2001834

Use SecUseridPwd  "ibm"  "password"  2001835

# Remedy
Use SecUseridPwd  "aradmin"  .  2001836

# Microsoft Office Sharepoint Server userid
Use SecUseridPwd  "sys(?:moss|wss)"  .  2001837

# ----------------------------------------------------------------------
# known userid = password => found twice in same or different argument(s)
#SecRule TX:known_userid  "@gt 1"  "phase:2,t:none,~{increaseBlockCounter},~{deny},tag:EXPLOIT,msg:'userid/password sent twice'"

# known userid & empty password, in same or different argument(s)
#SecRule &TX:known_userid "@eq 0"  "phase:2,t:none,tag:security,~{skipAfter}:AfterKnownUserid"
# Use SecRuleDeny ARGS|REQUEST_COOKIES  \"\"|\'\'|^$  "t:none"
#Use SecMarker AfterKnownUserid,tag:security